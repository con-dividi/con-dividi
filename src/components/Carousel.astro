---
import Modal from './Modal.astro';
import ModalContent from './ModalContent.astro';

export interface Props {
	images: Record<string, any>[];
}
const { images } = Astro.props;
---

<div id="custom-controls-gallerys" class="relative w-full py-50px" data-carousel="slide">
	<div class="relative h-56 2xl:h-128 overflow-hidden rounded-lg md:h-96">
		{
			images.map((e, i) => {
				return (
					<>
						<div class="hidden duration-700 ease-in-out" data-carousel-item>
							<img
								src={e.default}
								alt=""
								class="absolute block max-w-full h-auto -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2"
								onclick={'triggerDialog(' + i + ')'}
							/>
						</div>
						<Modal index={i}>
							<ModalContent i={i} image={e} />
						</Modal>
					</>
				);
			})
		}
	</div>
	<div class="flex justify-center items-center pt-4">
		<button
			type="button"
			class="flex justify-center items-center mr-4 h-full cursor-pointer group focus:outline-none"
			data-carousel-prev
		>
			<span
				class="text-gray-400 hover:text-gray-900 dark:hover:text-white group-focus:text-gray-900 dark:group-focus:text-white"
			>
				<svg
					aria-hidden="true"
					class="w-6 h-6"
					fill="currentColor"
					viewBox="0 0 20 20"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path
						fill-rule="evenodd"
						d="M7.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l2.293 2.293a1 1 0 010 1.414z"
						clip-rule="evenodd"></path>
				</svg>
				<span class="sr-only">Previous</span>
			</span>
		</button>
		<button
			type="button"
			class="flex justify-center items-center h-full cursor-pointer group focus:outline-none"
			data-carousel-next
		>
			<span
				class="text-gray-400 hover:text-gray-900 dark:hover:text-white group-focus:text-gray-900 dark:group-focus:text-white"
			>
				<svg
					aria-hidden="true"
					class="w-6 h-6"
					fill="currentColor"
					viewBox="0 0 20 20"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path
						fill-rule="evenodd"
						d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z"
						clip-rule="evenodd"></path>
				</svg>
				<span class="sr-only">Next</span>
			</span>
		</button>
	</div>
</div>

<script is:inline>
	function triggerDialog(i) {
		document.getElementById('modal_' + i)?.classList.toggle('hidden');
	}

	function nextImage(i) {
		let e = i + 1;
		let next = document.getElementById('modal_' + e);
		if (next == null) {
			e = 0;
		}
		console.log(i, e);
		document.getElementById('modal_' + i)?.classList.toggle('hidden');
		document.getElementById('modal_' + e)?.classList.toggle('hidden');
	}

	function prevImage(i) {
		let e = i - 1;
		if (i == 0) {
			e = document.querySelectorAll('._modal').length - 1;
		}
		console.log(i, e);
		document.getElementById('modal_' + i)?.classList.toggle('hidden');
		document.getElementById('modal_' + e)?.classList.toggle('hidden');
	}
</script>
